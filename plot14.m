%%%%%%%%% plot pr curve shrec 2013 dataset %%%%%%%%%%%%%%%%%%%%%

close all;
clear all;
clc;
%% pick up the certain points from precision-recall curve %%%%


resultsDir = './shrec14_precision_recall.txt';
holis = load(resultsDir);               %% Load the data for precision recall curve.
%% pick up the certain points from precision-recall curve %%%%
rec = holis(:,1);           % The first row is the data for recall
pre = holis(:,2);          % The second row is the data for precision
figure(1);


recall = [0.0500	0.1000	0.1500	0.2000	0.2500	0.3000	0.3500	0.4000	0.4500	0.5000	0.5500	0.6000	0.6500	0.7000	0.7500	0.8000	0.8500	0.9000	0.9500	1.0000];
dcml.precision = zeros(1, 20);
for i = 1 : 20
    index_s = find(rec < recall(i)); %% find rec smaller than recall(i)
    index_l = find(rec > recall(i));
    if ~isempty(index_s) && ~isempty(index_l)
        index_s = index_s(end);
        index_l = index_l(1);
        dcml.precision(i) = (pre(index_s) + pre(index_l))/2;
    elseif ~isempty(index_s) && isempty(index_l)
        index_s = index_s(end);
        dcml.precision(i) = pre(index_s);
    elseif isempty(index_s) && ~isempty(index_l)
        index_l = index_l(1);
        dcml.precision(i) = pre(index_l);
    end
        
end


tatsuma.precision_ophog = [0.216761000000000;0.172690000000000;0.134343000000000;0.109118000000000;0.0881520000000000;0.0759300000000000;0.0648310000000000;0.0564880000000000;0.0493500000000000;0.0424030000000000;0.0375270000000000;0.0331150000000000;0.0289140000000000;0.0250990000000000;0.0214810000000000;0.0183670000000000;0.0158560000000000;0.0135560000000000;0.0113820000000000;0.00880900000000000];
tatsuma.precision_scmr = [0.238373000000000;0.214587000000000;0.191388000000000;0.176220000000000;0.162755000000000;0.159643000000000;0.152551000000000;0.148741000000000;0.144420000000000;0.136460000000000;0.131686000000000;0.125898000000000;0.117680000000000;0.110655000000000;0.101584000000000;0.0895360000000000;0.0784190000000000;0.0663760000000000;0.0489620000000000;0.0238980000000000];
furuya.precision_bf = [0.164308000000000;0.116787000000000;0.0908570000000000;0.0744670000000000;0.0603500000000000;0.0513270000000000;0.0436870000000000;0.0386050000000000;0.0345410000000000;0.0311000000000000;0.0281550000000000;0.0253710000000000;0.0227160000000000;0.0203000000000000;0.0180580000000000;0.0159630000000000;0.0141960000000000;0.0124980000000000;0.0108420000000000;0.00843200000000000];
furuya.precision_s1a3 = [0.165725000000000;0.125856000000000;0.102131000000000;0.0871430000000000;0.0735490000000000;0.0645610000000000;0.0564030000000000;0.0508700000000000;0.0460910000000000;0.0413250000000000;0.0377730000000000;0.0344160000000000;0.0310800000000000;0.0279440000000000;0.0247220000000000;0.0212820000000000;0.0185570000000000;0.0160450000000000;0.0133840000000000;0.00990300000000000];
furuya.precision_s1a6 = [0.136681000000000;0.103486000000000;0.0849050000000000;0.0743780000000000;0.0649340000000000;0.0599510000000000;0.0530130000000000;0.0483670000000000;0.0446280000000000;0.0406150000000000;0.0373460000000000;0.0337910000000000;0.0308270000000000;0.0282830000000000;0.0253820000000000;0.0215550000000000;0.0187950000000000;0.0164320000000000;0.0142080000000000;0.0109580000000000];
furuya.precision_s5a3 = [0.172064000000000;0.127078000000000;0.104256000000000;0.0887830000000000;0.0746370000000000;0.0652730000000000;0.0572820000000000;0.0519700000000000;0.0471510000000000;0.0425010000000000;0.0391920000000000;0.0357410000000000;0.0323790000000000;0.0293480000000000;0.0261070000000000;0.0226450000000000;0.0198330000000000;0.0173320000000000;0.0143710000000000;0.0104450000000000];
furuya.precision_s5a6 = [0.156325000000000;0.121629000000000;0.104524000000000;0.0930180000000000;0.0828950000000000;0.0765980000000000;0.0682290000000000;0.0629070000000000;0.0587390000000000;0.0540860000000000;0.0500670000000000;0.0456390000000000;0.0414570000000000;0.0378920000000000;0.0339890000000000;0.0290020000000000;0.0251450000000000;0.0214390000000000;0.0177350000000000;0.0129970000000000];
li.precision_a5 = [0.148355000000000;0.110100000000000;0.0857020000000000;0.0743030000000000;0.0621540000000000;0.0556750000000000;0.0490460000000000;0.0443030000000000;0.0400260000000000;0.0354190000000000;0.0320920000000000;0.0290050000000000;0.0257920000000000;0.0233570000000000;0.0212550000000000;0.0190780000000000;0.0170430000000000;0.0149480000000000;0.0125300000000000;0.00913200000000000];
li.precision_a10 = [0.157005000000000;0.119197000000000;0.0937560000000000;0.0801800000000000;0.0681490000000000;0.0610680000000000;0.0538760000000000;0.0489940000000000;0.0449740000000000;0.0399800000000000;0.0360940000000000;0.0326360000000000;0.0287350000000000;0.0257910000000000;0.0232830000000000;0.0209230000000000;0.0185940000000000;0.0162030000000000;0.0136140000000000;0.00993200000000000];
zou.precision_p32w128 = [0.135302000000000;0.0944700000000000;0.0735070000000000;0.0556620000000000;0.0461420000000000;0.0399250000000000;0.0351600000000000;0.0304680000000000;0.0274210000000000;0.0246430000000000;0.0225810000000000;0.0205280000000000;0.0186040000000000;0.0170320000000000;0.0154450000000000;0.0140400000000000;0.0126610000000000;0.0108430000000000;0.00963000000000000;0.00792700000000000];
zou.precision_w800 = [0.135343000000000;0.104690000000000;0.0835910000000000;0.0658560000000000;0.0540610000000000;0.0469330000000000;0.0417760000000000;0.0374890000000000;0.0338260000000000;0.0303230000000000;0.0274020000000000;0.0248100000000000;0.0225070000000000;0.0204200000000000;0.0184440000000000;0.0166700000000000;0.0147780000000000;0.0129520000000000;0.0112630000000000;0.00853300000000000];
zou.precision_w1000 = [0.127027000000000;0.0941030000000000;0.0735990000000000;0.0579210000000000;0.0485550000000000;0.0426570000000000;0.0374420000000000;0.0334630000000000;0.0304040000000000;0.0272900000000000;0.0251440000000000;0.0231070000000000;0.0211480000000000;0.0194190000000000;0.0175920000000000;0.0159210000000000;0.0142630000000000;0.0123390000000000;0.0106690000000000;0.00826900000000000];

marksize = 6;
linewidth = 1.5;
plot(recall, dcml.precision, '-s','LineWidth',linewidth,...
                       'Color', [1 0 1], ...
                       'MarkerEdgeColor',[1 0 1],...
                       'MarkerSize',marksize);
hold on;
plot(recall, furuya.precision_bf, '-x','LineWidth',linewidth,...
                       'Color', [1 0 0], ...
                       'MarkerEdgeColor',[1 0 0],...
                       'MarkerFaceColor',[1 0 0],...
                       'MarkerSize',marksize);
hold on;
plot(recall, furuya.precision_s1a6, '-v','LineWidth',linewidth,...
                       'Color', [1 0 0], ...
                       'MarkerEdgeColor',[1 0 0],...
                       'MarkerFaceColor',[1 0 0],...
                       'MarkerSize',marksize); 
plot(recall, furuya.precision_s1a3, '-^','LineWidth',linewidth,...
                       'Color', [0 0 1], ...
                       'MarkerEdgeColor',[0 0 1],...
                       'MarkerFaceColor',[0 0 1],...
                       'MarkerSize',marksize);
                  
hold on;
plot(recall, furuya.precision_s5a3, '-x','LineWidth',linewidth,...
                       'Color', [0 0 0], ...
                       'MarkerEdgeColor',[0 0 0],...
                       'MarkerFaceColor',[0 0 0],...
                       'MarkerSize',marksize); 
hold on;
plot(recall, furuya.precision_s5a6, '-+','LineWidth',linewidth,...
                       'Color', [0 0 0], ...
                       'MarkerEdgeColor',[0 0 0],...
                       'MarkerFaceColor',[0 0 0],...
                       'MarkerSize',marksize);

hold on;
plot(recall, li.precision_a5, '-','LineWidth',linewidth,...
                       'Color', [0 0 1], ...
                       'MarkerEdgeColor',[0 0 1],...
                       'MarkerFaceColor',[0 0 1],...
                       'MarkerSize',marksize);
                   
hold on;
plot(recall, li.precision_a10, '-','LineWidth',linewidth,...
                       'Color', [0 0 0], ...
                       'MarkerEdgeColor',[0 0 0],...
                       'MarkerFaceColor',[0 0 0],...
                       'MarkerSize',marksize);
hold on;
plot(recall, tatsuma.precision_ophog, '-p','LineWidth',linewidth,...
                        'Color', [1 0 0], ...
                       'MarkerEdgeColor','r',...
                       'MarkerFaceColor','r',...
                       'MarkerSize',marksize);
hold on;
plot(recall, tatsuma.precision_scmr, '-','LineWidth',linewidth,...
                        'Color', [1 0 0], ...
                       'MarkerEdgeColor','r',...
                       'MarkerFaceColor','r',...
                       'MarkerSize',marksize);
                       

hold on;
plot(recall, zou.precision_p32w128, '-','LineWidth',linewidth,...
                       'Color', [0 1 0], ...
                       'MarkerEdgeColor',[0 1 0],...
                       'MarkerSize',marksize);
hold on;
plot(recall, zou.precision_w800, '-d','LineWidth',linewidth,...
                       'Color', [0 0 1], ...
                       'MarkerEdgeColor',[0 0 1],...
                       'MarkerSize',marksize);
hold on;
plot(recall, zou.precision_w1000, '-*','LineWidth',linewidth,...
                       'Color', [0 1 1], ...
                       'MarkerEdgeColor',[0 1 1],...
                       'MarkerSize',marksize);

handle_legend = legend('Proposed', 'Furuya(BF-fGALIF)', 'Furuya(CDMR(\sigma_{SM}=0.1, \alpha=0.6))', 'Furuya(CDMR(\sigma_{SM}=0.1, \alpha=0.3))', 'Furuya(CDMR(\sigma_{SM}=0.05, \alpha=0.6))',...
    'Furuya(CDMR(\sigma_{SM}=0.05, \alpha=0.3))', 'LI(SBR-VC(\alpha=1))', 'Li(SBR-VC(\alpha=1/2))', 'Tatsuma(OPHOG)', 'Tatsuma(SCMR-OPHOG)', 'Zou(BOF-JESC (Words800\_VQ))', ...
    'Zou(BOF-JESC(Words1000\_VQ))', 'Zou(Zou(BOF-JESC(FV\_PCA32\_Words128))');
set(handle_legend, 'FontSize', 10, 'Fontname','Timesnewroman');
handlexlabel = xlabel('Recall');
set(handlexlabel, 'FontSize', 12, 'Fontname','Timesnewroman');
handle_ylabel = ylabel('Precision');
set(handle_ylabel, 'FontSize', 12, 'Fontname','Timesnewroman');

% figure(2);


